(function() {
  shaders["pixar.fs"] = THREE.ShaderChunk["common"] + "\n\nvarying vec3 lightRGB;\nvarying vec3 lightHSV;\nvarying vec3 rim;\n\nuniform vec3 diffuse;\nuniform sampler2D map;\n\n" + THREE.ShaderChunk["uv_pars_fragment"] + "\n" + THREE.ShaderChunk["color_pars_fragment"] + "\n\n" + THREE.ShaderChunk["shadowmap_pars_fragment"] + "\n\n" + shaders["hsv"] + "\n\nvoid main(void) {\n\n    vec4 diffuseColor = vec4(1.0, 1.0, 1.0, 1.0);\n    " + THREE.ShaderChunk["color_fragment"] + "\n\n    vec4 diffuseRGB = texture2D(map, vUv) * diffuseColor;\n    diffuseRGB.rgb = diffuseRGB.rgb * diffuse;\n\n    if (diffuseRGB.a > 0.1) {\n\n      vec3 shadowMask = vec3(1.0);\n      " + THREE.ShaderChunk["shadowmap_fragment"] + "\n\n      vec3 diffuseHSV = rgb2hsv(diffuseRGB.rgb);\n      diffuseHSV.g = diffuseHSV.g + (1.0 - min(lightHSV.b * shadowMask.r, 1.0));\n      diffuseHSV.b = diffuseHSV.b * shadowMask.r;\n      diffuseRGB = vec4(hsv2rgb(diffuseHSV) * lightRGB, 1.0);\n      gl_FragColor = diffuseRGB + vec4(rim,1.0);\n    }\n    else {\n      discard;\n    }\n}\n";

}).call(this);
